<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Membresías</title>
    <!-- Incluir Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="auth.js"></script>
</head>
<body class="bg-gray-100">
    <!-- Header -->
    <header class="bg-white shadow-md">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#" class="text-2xl font-bold text-gray-800">MiEmpresa</a>
            <nav class="space-x-4">
                <a href="#" class="text-gray-700 hover:text-blue-600">Inicio</a>
                <a href="#" class="text-gray-700 hover:text-blue-600">Membresías</a>
                <a href="#" class="text-gray-700 hover:text-blue-600">Contacto</a>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="bg-blue-600 text-white py-20">
        <div class="container mx-auto px-6 text-center">
            <h1 class="text-4xl font-bold mb-4">Membresías Activas</h1>
            <p class="text-lg">Aquí puedes ver todas las membresías activas de nuestros usuarios.</p>
        </div>
    </section>

    <!-- Membresías Section -->
    <section class="container mx-auto px-6 py-16">
        <div id="membresias-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-h-96 overflow-y-scroll">
            
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2023 MiEmpresa. Todos los derechos reservados.</p>
            <p class="mt-2">Síguenos en <a href="#" class="text-blue-400 hover:text-blue-300">Twitter</a> y <a href="#" class="text-blue-400 hover:text-blue-300">Facebook</a>.</p>
        </div>
    </footer>

    <!-- Script para cargar las membresías desde la API -->
    <script>
        // Función para formatear la fecha en un formato legible
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('es-ES', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
            });
        }

        // Función para renderizar las membresías
        function renderMembresias(membresias) {
            const container = document.getElementById('membresias-container');
            container.innerHTML = ''; // Limpiar el contenedor

            membresias.forEach(membresia => {
                const card = document.createElement('div');
                card.className = 'bg-white p-6 rounded-lg shadow-lg';

                card.innerHTML = `
                    <h2 class="text-xl font-bold text-gray-800 mb-2">${membresia.nombre_plan}</h2>
                    <p class="text-gray-600 mb-4">Usuario: ${membresia.nombre_completo} (${membresia.username})</p>
                    <p class="text-gray-600 mb-2"><strong>Inicio:</strong> ${formatDate(membresia.fecha_inicio)}</p>
                    <p class="text-gray-600 mb-4"><strong>Fin:</strong> ${formatDate(membresia.fecha_fin)}</p>
                    <p class="text-gray-600 mb-4"><strong>ID Membresía:</strong> ${membresia.membresia_id}</p>
                    <p class="text-gray-600 mb-4"><strong>ID Usuario:</strong> ${membresia.usuario_id}</p>
                `;

                container.appendChild(card);
            });
        }

        // Función para obtener las membresías desde la API
        async function fetchMembresias() {
    try {
        const response = await fetchWithAuth('https://api-gymya-api.onrender.com/api/membresias/activas');
        const data = await response.json();

        if (response.ok) {
            renderMembresias(data.membresias);
        } else {
            console.error('Error al obtener las membresías:', data);
        }
    } catch (error) {
        console.error('Error de conexión:', error);
    }
}


        // Cargar las membresías al abrir la página
        fetchMembresias();
    </script>
</body>
</html>